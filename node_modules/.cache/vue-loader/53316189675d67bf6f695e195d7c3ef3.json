{"remainingRequest":"/Users/liuhaobo/Desktop/fe-lost-found/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/liuhaobo/Desktop/fe-lost-found/src/views/home/send.vue?vue&type=style&index=0&id=bd644be4&lang=scss&scoped=true&","dependencies":[{"path":"/Users/liuhaobo/Desktop/fe-lost-found/src/views/home/send.vue","mtime":1557237073404},{"path":"/Users/liuhaobo/Desktop/fe-lost-found/node_modules/css-loader/index.js","mtime":499162500000},{"path":"/Users/liuhaobo/Desktop/fe-lost-found/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/liuhaobo/Desktop/fe-lost-found/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/liuhaobo/Desktop/fe-lost-found/node_modules/sass-loader/lib/loader.js","mtime":1533139052000},{"path":"/Users/liuhaobo/Desktop/fe-lost-found/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/liuhaobo/Desktop/fe-lost-found/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.imgfile {\n  margin: 20px 0;\n  .filetitle {\n    margin: 10px 0;\n  }\n}\n.content {\n  width: 1200px;\n  margin: 0 auto;\n  .content-li {\n    margin: 30px 0;\n    font-size: 20px;\n  }\n  .upload-demo {\n    margin: 30px 0;\n  }\n  .el-textarea__inner {\n    width: 200px !important;\n  }\n  .el-input {\n    margin: 20px 0;\n    width: 400px;\n  }\n}\n",{"version":3,"sources":["send.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"send.vue","sourceRoot":"src/views/home","sourcesContent":["<template>\n  <div class=\"content\">\n    <div class=\"imgfile\">\n      <h3 class=\"filetitle\">请上传物品图片：</h3>\n      <input type=\"file\" @change=\"previewFile()\" ref=\"file\">\n    </div>\n    <div class=\"imageurl\">\n      <img\n        v-if=\"params.itemImg\"\n        :src=\"params.itemImg\"\n        width=\"200\"\n        height=\"200\"\n        alt=\"Image preview...\"\n      >\n    </div>\n    <el-input type=\"textarea\" :rows=\"4\" placeholder=\"请输入描述\" v-model=\"params.itemInfo\"></el-input>\n    <el-input v-model=\"params.phone\" placeholder=\"请输入联系电话\"></el-input>\n    <br>\n    <el-input v-model=\"params.wchat\" placeholder=\"请输入微信\"></el-input>\n    <br>\n    <el-button type=\"primary\" @click=\"sendfood\">发布</el-button>\n  </div>\n</template>\n\n<script>\nimport qs from \"qs\";\n\nexport default {\n  data() {\n    return {\n      fileList: [],\n      params: {\n        itemImg: \"\",\n        itemInfo: \"\",\n        phone: \"\",\n        wchat: \"\",\n        lat: localStorage.getItem(\"lat\"),\n        lon: localStorage.getItem(\"lng\"),\n        lostTime: Date.now(),\n        userId: this.$store.getters.userid,\n        offBase: 0\n      },\n      filelist: {\n        file: null,\n        itemId: 0\n      }\n    };\n  },\n  mounted() {},\n  methods: {\n    previewFile() {\n      this.filelist.file = this.$refs.file.files[0];\n      if (this.filelist.file.size > 1024 * 1024 * 2) {\n        alert(\"图片大小不能超过 2MB!\");\n        return false;\n      }\n      // 创建url\n      this.params.itemImg = window.URL.createObjectURL(this.filelist.file);\n    },\n    async sendfood() {\n      if (this.file === null) {\n        this.$notify({\n          title: \"警告\",\n          showClose: false,\n          message: \"请上传图片\"\n        });\n        return;\n      } else if (this.params.itemInfo === \"\") {\n        this.$notify({\n          title: \"警告\",\n          showClose: false,\n          message: \"描述不能为空\"\n        });\n        return;\n      } else if (this.params.phone === \"\" || this.params.phone.length !== 11) {\n        this.$notify({\n          title: \"警告\",\n          showClose: false,\n          message: \"手机号格式不正确\"\n        });\n        return;\n      } else if (this.params.wchat === \"\") {\n        this.$notify({\n          title: \"警告\",\n          showClose: false,\n          message: \"微信不能为空\"\n        });\n        return;\n      }\n      await this.$api.api.createItem(this.params).then(res => {\n        if (res.data.state === 0) {\n          this.filelist.itemId = res.data.info.itemId;\n        }\n      });\n      const formdata = new FormData();\n      formdata.append(\"file\", this.filelist.file);\n      await this.$api.api\n        .createItemImg(formdata, this.filelist.itemId)\n        .then(res => {\n          if (res.data.state === 0) {\n            alert(\"上传成功\");\n          }\n        });\n      this.$router.push({\n        path: \"/\"\n      });\n    }\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.imgfile {\n  margin: 20px 0;\n  .filetitle {\n    margin: 10px 0;\n  }\n}\n.content {\n  width: 1200px;\n  margin: 0 auto;\n  .content-li {\n    margin: 30px 0;\n    font-size: 20px;\n  }\n  .upload-demo {\n    margin: 30px 0;\n  }\n  .el-textarea__inner {\n    width: 200px !important;\n  }\n  .el-input {\n    margin: 20px 0;\n    width: 400px;\n  }\n}\n</style>\n"]}]}