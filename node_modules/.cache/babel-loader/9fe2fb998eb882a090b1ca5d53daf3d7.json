{"remainingRequest":"/Users/liuhaobo/Desktop/fe-lost-found/node_modules/babel-loader/lib/index.js!/Users/liuhaobo/Desktop/fe-lost-found/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/liuhaobo/Desktop/fe-lost-found/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/liuhaobo/Desktop/fe-lost-found/src/views/home/send.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/liuhaobo/Desktop/fe-lost-found/src/views/home/send.vue","mtime":1557237073404},{"path":"/Users/liuhaobo/Desktop/fe-lost-found/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/liuhaobo/Desktop/fe-lost-found/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/liuhaobo/Desktop/fe-lost-found/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/liuhaobo/Desktop/fe-lost-found/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/Users/liuhaobo/Desktop/fe-lost-found/node_modules/@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _Date$now from \"/Users/liuhaobo/Desktop/fe-lost-found/node_modules/@babel/runtime-corejs2/core-js/date/now\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport qs from \"qs\";\nexport default {\n  data: function data() {\n    return {\n      fileList: [],\n      params: {\n        itemImg: \"\",\n        itemInfo: \"\",\n        phone: \"\",\n        wchat: \"\",\n        lat: localStorage.getItem(\"lat\"),\n        lon: localStorage.getItem(\"lng\"),\n        lostTime: _Date$now(),\n        userId: this.$store.getters.userid,\n        offBase: 0\n      },\n      filelist: {\n        file: null,\n        itemId: 0\n      }\n    };\n  },\n  mounted: function mounted() {},\n  methods: {\n    previewFile: function previewFile() {\n      this.filelist.file = this.$refs.file.files[0];\n\n      if (this.filelist.file.size > 1024 * 1024 * 2) {\n        alert(\"图片大小不能超过 2MB!\");\n        return false;\n      } // 创建url\n\n\n      this.params.itemImg = window.URL.createObjectURL(this.filelist.file);\n    },\n    sendfood: function () {\n      var _sendfood = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee() {\n        var _this = this;\n\n        var formdata;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (!(this.file === null)) {\n                  _context.next = 5;\n                  break;\n                }\n\n                this.$notify({\n                  title: \"警告\",\n                  showClose: false,\n                  message: \"请上传图片\"\n                });\n                return _context.abrupt(\"return\");\n\n              case 5:\n                if (!(this.params.itemInfo === \"\")) {\n                  _context.next = 10;\n                  break;\n                }\n\n                this.$notify({\n                  title: \"警告\",\n                  showClose: false,\n                  message: \"描述不能为空\"\n                });\n                return _context.abrupt(\"return\");\n\n              case 10:\n                if (!(this.params.phone === \"\" || this.params.phone.length !== 11)) {\n                  _context.next = 15;\n                  break;\n                }\n\n                this.$notify({\n                  title: \"警告\",\n                  showClose: false,\n                  message: \"手机号格式不正确\"\n                });\n                return _context.abrupt(\"return\");\n\n              case 15:\n                if (!(this.params.wchat === \"\")) {\n                  _context.next = 18;\n                  break;\n                }\n\n                this.$notify({\n                  title: \"警告\",\n                  showClose: false,\n                  message: \"微信不能为空\"\n                });\n                return _context.abrupt(\"return\");\n\n              case 18:\n                _context.next = 20;\n                return this.$api.api.createItem(this.params).then(function (res) {\n                  if (res.data.state === 0) {\n                    _this.filelist.itemId = res.data.info.itemId;\n                  }\n                });\n\n              case 20:\n                formdata = new FormData();\n                formdata.append(\"file\", this.filelist.file);\n                _context.next = 24;\n                return this.$api.api.createItemImg(formdata, this.filelist.itemId).then(function (res) {\n                  if (res.data.state === 0) {\n                    alert(\"上传成功\");\n                  }\n                });\n\n              case 24:\n                this.$router.push({\n                  path: \"/\"\n                });\n\n              case 25:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function sendfood() {\n        return _sendfood.apply(this, arguments);\n      }\n\n      return sendfood;\n    }()\n  }\n};",{"version":3,"sources":["send.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"content\">\n    <div class=\"imgfile\">\n      <h3 class=\"filetitle\">请上传物品图片：</h3>\n      <input type=\"file\" @change=\"previewFile()\" ref=\"file\">\n    </div>\n    <div class=\"imageurl\">\n      <img\n        v-if=\"params.itemImg\"\n        :src=\"params.itemImg\"\n        width=\"200\"\n        height=\"200\"\n        alt=\"Image preview...\"\n      >\n    </div>\n    <el-input type=\"textarea\" :rows=\"4\" placeholder=\"请输入描述\" v-model=\"params.itemInfo\"></el-input>\n    <el-input v-model=\"params.phone\" placeholder=\"请输入联系电话\"></el-input>\n    <br>\n    <el-input v-model=\"params.wchat\" placeholder=\"请输入微信\"></el-input>\n    <br>\n    <el-button type=\"primary\" @click=\"sendfood\">发布</el-button>\n  </div>\n</template>\n\n<script>\nimport qs from \"qs\";\n\nexport default {\n  data() {\n    return {\n      fileList: [],\n      params: {\n        itemImg: \"\",\n        itemInfo: \"\",\n        phone: \"\",\n        wchat: \"\",\n        lat: localStorage.getItem(\"lat\"),\n        lon: localStorage.getItem(\"lng\"),\n        lostTime: Date.now(),\n        userId: this.$store.getters.userid,\n        offBase: 0\n      },\n      filelist: {\n        file: null,\n        itemId: 0\n      }\n    };\n  },\n  mounted() {},\n  methods: {\n    previewFile() {\n      this.filelist.file = this.$refs.file.files[0];\n      if (this.filelist.file.size > 1024 * 1024 * 2) {\n        alert(\"图片大小不能超过 2MB!\");\n        return false;\n      }\n      // 创建url\n      this.params.itemImg = window.URL.createObjectURL(this.filelist.file);\n    },\n    async sendfood() {\n      if (this.file === null) {\n        this.$notify({\n          title: \"警告\",\n          showClose: false,\n          message: \"请上传图片\"\n        });\n        return;\n      } else if (this.params.itemInfo === \"\") {\n        this.$notify({\n          title: \"警告\",\n          showClose: false,\n          message: \"描述不能为空\"\n        });\n        return;\n      } else if (this.params.phone === \"\" || this.params.phone.length !== 11) {\n        this.$notify({\n          title: \"警告\",\n          showClose: false,\n          message: \"手机号格式不正确\"\n        });\n        return;\n      } else if (this.params.wchat === \"\") {\n        this.$notify({\n          title: \"警告\",\n          showClose: false,\n          message: \"微信不能为空\"\n        });\n        return;\n      }\n      await this.$api.api.createItem(this.params).then(res => {\n        if (res.data.state === 0) {\n          this.filelist.itemId = res.data.info.itemId;\n        }\n      });\n      const formdata = new FormData();\n      formdata.append(\"file\", this.filelist.file);\n      await this.$api.api\n        .createItemImg(formdata, this.filelist.itemId)\n        .then(res => {\n          if (res.data.state === 0) {\n            alert(\"上传成功\");\n          }\n        });\n      this.$router.push({\n        path: \"/\"\n      });\n    }\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.imgfile {\n  margin: 20px 0;\n  .filetitle {\n    margin: 10px 0;\n  }\n}\n.content {\n  width: 1200px;\n  margin: 0 auto;\n  .content-li {\n    margin: 30px 0;\n    font-size: 20px;\n  }\n  .upload-demo {\n    margin: 30px 0;\n  }\n  .el-textarea__inner {\n    width: 200px !important;\n  }\n  .el-input {\n    margin: 20px 0;\n    width: 400px;\n  }\n}\n</style>\n"],"sourceRoot":"src/views/home"}]}